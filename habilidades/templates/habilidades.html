{% extends "template.html" %}
{% load staticfiles %}
{% block head %}
	<title>Habilidades | OportunidApp </title>
{% endblock %}
{% block content %}
<div class="row">
	<div class="full col-sm-12">
		<div class="nav-center">
			<ul class="nav nav-pills">
				<li><a href="#"><i class="glyphicon glyphicon-user desc2"></i>  <span class="desc">Te necesito</span></a></li>
				<li class="active"><a href="#"><i class="glyphicon glyphicon-thumbs-up desc2"></i> <span class="desc">Habilidades</span></a></li>
				<li><a href="#"><i class="glyphicon glyphicon-list-alt desc2"></i> <span class="desc">Trabajos</span></a></li>
				<li><a href="#"><i class="glyphicon glyphicon-pushpin desc2"></i> <span class="desc">Solicitudes</span></a></li>
			</ul>
		</div>  
	</div>
</div>
<div class="col-sm-12">
	<a href="" class="btn btn-primary pull" id="hbl">Nueva Habilidad</a>
	<button id="gethab"> List</button>
</div>
<div class="col-sm-12">
	<div class="well"> 
		<form id="nueva-habilidad-form" method="post">
			<h4>Nueva Habilidad</h4>

			<div class="form-group" style="padding:14px;">
				{{ form.as_p }}
				<p>
					<label for="exampleInputFile">Subir Imagen</label>
    				<input type="file" class="file">
				</p>
			</div>
			<div class="text-right">
				<a href="" class="btn btn-danger" id="cancel">Cancelar</a>
				<input type="submit" value="Agregar + " class="btn btn-primary">
			</div>
			<ul class="list-inline">
			</ul>
		</form>
	</div>
</div>
{%verbatim%}

<ul id="listul">
<script id="habilidadesTempl" type="text/x-handlebars-template">
{{#each this }}
<div class="habilidad-item">
	<div className="col-sm-12">
		<div class="row panel panel-default">
			<div class="col-sm-12 col-md-4 col-lg-3 div-align">
				<img src="http://straightlinem.com/wp-content/uploads/2014/11/california-contractor-insurance.jpg" class="desc-img" alt="Responsive image">
			</div>
			<div class="col-sm-12 col-md-5 col-lg-6 div-align">
				<h3>{{ fields.nhabilidad }}</h3>
				<p>{{ fields.descripcion }}</p>
				<div class="col-sm-12 col-md-3 col-lg-3">
					<div class="text-top text-center col-xs-12 col-sm-4 col-md-12 col-lg-12">
						<div class="label-descp label-warning">
							Puntuaci√≥n: <strong>{{ fields.val_promedio }}</strong>
						</div>
					</div>
					<div class="text-top text-center col-xs-12 col-sm-4 col-md-12 col-lg-12">
						<div class="label-descp label-success">
							Solicitudes: <strong>{{ fields.num_solicitudes }}</strong>
						</div>
					</div>
					<div class="text-top text-center col-xs-12 col-sm-4 col-md-12 col-lg-12">
						<div class="label-descp label-danger">
							Precio: <strong>$ {{ fields.precio }}</strong>
						</div>
					</div>
				</div>
			</div>
		<div>
	</div>
</div>
{{/each}}
</script>
</ul>
{%endverbatim%}

{% endblock %}
{% block scripts %}
	<script src="{% static 'jsapp/csrf_load.js' %}"></script>
	<script>
		$(function() {
			$('#nueva-habilidad-form').on('submit', function(event){
				event.preventDefault();
				nuevaHabilidad();
			});
			function nuevaHabilidad () {
				$.ajax({
					url: '/habilidades/nueva/',
					type: "POST",
					dataType: 'json',
					data: {
						categoria: $('#id_categoria').val(),
						nhabilidad: $('#id_nhabilidad').val(),
						descripcion: $('#id_descripcion').val(),
						precio: $('#id_precio').val(),
					},
					success: function(json){
						//var data = jQuery.parseJSON(json);
						console.log(json);
					},
				}); 
			};

			$('#gethab').click(function(){
				getHabilidades();
			});
			function getHabilidades () {
				$.ajax({
					url: '/habilidades/list/',
					type: "GET",
					success: function(json){
						console.log(json);
						var source   = $("#habilidadesTempl").html();
						var template = Handlebars.compile(source);
						t = template(json);
						console.log(t);
						$("#listul").append(t); 
					},
				});
			};
			
		});

		$('.well').hide();
		$('#hbl').click(function(event){
			$('.well').show();	
			$('#hbl').hide();
			event.preventDefault();
		});
		$('#cancel').click(function(event){
			$('.well').hide();
			$('#hbl').show();
			event.preventDefault();
		});
	</script>
{% endblock %}